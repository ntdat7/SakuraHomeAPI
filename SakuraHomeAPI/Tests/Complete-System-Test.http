### ==================================================================================
### SAKURAHOME API - COMPLETE SYSTEM TEST SUITE
### ==================================================================================
### 
### File này test tất cả các chức năng chính của hệ thống:
### 
### 🔐 AUTHENTICATION & AUTHORIZATION
### 👤 USER MANAGEMENT 
### 🏪 PRODUCT MANAGEMENT
### 🛒 SHOPPING CART
### 📝 WISHLIST
### 💳 ORDER MANAGEMENT
### 💰 PAYMENT SYSTEM
### 📦 SHIPPING SYSTEM
### ⭐ REVIEWS & RATINGS
### 🎫 COUPONS & PROMOTIONS
### 📧 NOTIFICATIONS
### 👨‍💼 ADMIN OPERATIONS
### 
### Author: GitHub Copilot
### Version: 1.0
### Last Updated: 2025-01-08
### 
### ==================================================================================

@baseUrl = https://localhost:8080
@baseUrlHttp = http://localhost:8080

# ==================================================================================
# GLOBAL VARIABLES - Sẽ được cập nhật trong quá trình test
# ==================================================================================

@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIxZGJkOTljMC1iMzI5LTRmNWMtOTM1Ny1mMTFhYWNiYmI1NmMiLCJlbWFpbCI6ImFkbWluQHNha3VyYWhvbWUuY29tIiwidW5pcXVlX25hbWUiOiJBZG1pbiBTeXN0ZW0iLCJyb2xlIjoiU3VwZXJBZG1pbiIsImZpcnN0TmFtZSI6IkFkbWluIiwibGFzdE5hbWUiOiJTeXN0ZW0iLCJ0aWVyIjoiQnJvbnplIiwic3RhdHVzIjoiQWN0aXZlIiwiZW1haWxWZXJpZmllZCI6IlRydWUiLCJwaG9uZVZlcmlmaWVkIjoiRmFsc2UiLCJwb2ludHMiOiIwIiwidG90YWxTcGVudCI6IjAuMDAiLCJwcmVmZXJyZWRMYW5ndWFnZSI6InZpIiwicHJlZmVycmVkQ3VycmVuY3kiOiJWTkQiLCJqdGkiOiIwMTg5NGZhNC1hNzRlLTQ1ZGQtOTYyYi03Y2Q5MzNiMGYyYTEiLCJpYXQiOjE3NTc4NDExMTgsImdlbmRlciI6IlVua25vd24iLCJuYmYiOjE3NTc4NDExMTgsImV4cCI6MTc1Nzg0NDcxOCwiaXNzIjoiU2FrdXJhSG9tZUFQSSIsImF1ZCI6IlNha3VyYUhvbWVVc2VycyJ9.Ipdqy8ttgihX47k6qPOvA_kzEPLsBv8q7jRc9HMzSqc
@customerToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiIzYmVlOGRiOC1iMjEwLTQwYjctYWJmYy03YWI4ZWEzNjA0MzMiLCJlbWFpbCI6InRlc3QuY3VzdG9tZXJAc2FrdXJhaG9tZS5jb20iLCJ1bmlxdWVfbmFtZSI6IlRlc3QgVXBkYXRlZCBDdXN0b21lciBVcGRhdGVkIiwicm9sZSI6IkN1c3RvbWVyIiwiZmlyc3ROYW1lIjoiVGVzdCBVcGRhdGVkIiwibGFzdE5hbWUiOiJDdXN0b21lciBVcGRhdGVkIiwidGllciI6IkJyb256ZSIsInN0YXR1cyI6IkFjdGl2ZSIsImVtYWlsVmVyaWZpZWQiOiJGYWxzZSIsInBob25lVmVyaWZpZWQiOiJGYWxzZSIsInBvaW50cyI6IjAiLCJ0b3RhbFNwZW50IjoiMC4wMCIsInByZWZlcnJlZExhbmd1YWdlIjoidmkiLCJwcmVmZXJyZWRDdXJyZW5jeSI6IlZORCIsImp0aSI6IjY5YmI4ZWI0LTJjYTAtNDZmMS1hN2Q2LTdiNWNmM2IxMzkzYSIsImlhdCI6MTc1Nzg0MTA2MiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbW9iaWxlcGhvbmUiOiIrODQ5MDEyMzQ1NjciLCJiaXJ0aGRhdGUiOiIxOTk1LTA1LTE1IiwiZ2VuZGVyIjoiTWFsZSIsIm5iZiI6MTc1Nzg0MTA2MiwiZXhwIjoxNzU3ODQ0NjYyLCJpc3MiOiJTYWt1cmFIb21lQVBJIiwiYXVkIjoiU2FrdXJhSG9tZVVzZXJzIn0.2q794ZGoBeIXIMHs3_YCiQZkPygi_XIOO0SK-pZBRC4
@staffToken = 
@customerId = 3bee8db8-b210-40b7-abfc-7ab8ea360433
@adminId = 1dbd99c0-b329-4f5c-9357-f11aacbbb56c
@staffId = 
@productId = 
@orderId = 
@cartId = 
@wishlistId = 
@addressId = 20
@couponId = 
@reviewId = 
@notificationId = 
@paymentId = 
@shippingId = 

### ==================================================================================
### 🔐 SECTION 1: AUTHENTICATION & AUTHORIZATION TESTS
### ==================================================================================

### 1.1 ✅ Đăng ký tài khoản khách hàng mới
# @name registerCustomer
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "email": "test.customer@sakurahome.com",
  "password": "TestPass123!",
  "confirmPassword": "TestPass123!",
  "firstName": "Test",
  "lastName": "Customer",
  "phoneNumber": "+84901234567",
  "dateOfBirth": "1995-05-15",
  "gender": 1,
  "acceptTerms": true
}

### 1.2 ✅ Đăng nhập tài khoản khách hàng
# @name loginCustomer
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "test.customer@sakurahome.com",
  "password": "TestPass123!",
  "rememberMe": false
}

### 1.3 ✅ Đăng nhập tài khoản Admin (để test chức năng admin)
# @name loginAdmin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@sakurahome.com",
  "password": "Admin123!",
  "rememberMe": true
}

### 1.4 ✅ Lấy thông tin user hiện tại
GET {{baseUrl}}/api/auth/me
Authorization: Bearer @customerToken

### 1.5 ✅ Kiểm tra trạng thái authentication
GET {{baseUrl}}/api/auth/check
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 1.6 ✅ Đổi mật khẩu
POST {{baseUrl}}/api/auth/change-password
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "currentPassword": "TestPass123!",
  "newPassword": "NewTestPass123!",
  "confirmPassword": "NewTestPass123!"
}

### 1.7 ✅ Refresh Token
POST {{baseUrl}}/api/auth/refresh-token
Content-Type: application/json

{
  "refreshToken": "{{loginCustomer.response.body.data.refreshToken}}"
}

### 1.8 ✅ Quên mật khẩu
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
  "email": "test.customer@sakurahome.com"
}

### ==================================================================================
### 👤 SECTION 2: USER PROFILE & ADDRESS MANAGEMENT
### ==================================================================================

### 2.1 ✅ Lấy thông tin profile
GET {{baseUrl}}/api/user/profile
Authorization: Bearer {{customerToken}}

### 2.2 ✅ Cập nhật profile
PUT {{baseUrl}}/api/user/profile
Authorization: Bearer {{customerToken}}
Content-Type: application/json

{
  "firstName": "Test Updated",
  "lastName": "Customer Updated",
  "phoneNumber": "+84901234567",
  "dateOfBirth": "1995-05-15",
  "gender": 1,
  "preferredLanguage": "vi",
  "preferredCurrency": "VND"
}

### 2.3 ✅ Lấy thống kê user
GET {{baseUrl}}/api/user/stats
Authorization: Bearer {{customerToken}}

### 2.4 ✅ Lấy danh sách địa chỉ
GET {{baseUrl}}/api/user/addresses
Authorization: Bearer {{customerToken}}

### 2.5 ✅ Thêm địa chỉ mới
# @name createAddress
POST {{baseUrl}}/api/user/addresses
Authorization: Bearer {{customerToken}}
Content-Type: application/json

{
  "name": "Test Customer",
  "phone": "+84901234567",
  "addressLine1": "123 Test Street",
  "addressLine2": "Apartment 4B",
  "provinceId": 1,
  "wardId": 1,
  "postalCode": "70000",
  "country": "Vietnam",
  "type": 0,
  "isDefault": true,
  "notes": "Địa chỉ nhà riêng"
}

### 2.6 ✅ Cập nhật địa chỉ
PUT {{baseUrl}}/api/user/addresses/{{addressId}}
Authorization: Bearer {{customerToken}}
Content-Type: application/json

{
  "name": "Test Customer Updated",
  "phone": "+84901234567",
  "addressLine1": "456 Updated Street",
  "addressLine2": "Floor 5",
  "provinceId": 1,
  "wardId": 1,
  "postalCode": "70000",
  "country": "Vietnam",
  "type": 0,
  "isDefault": true,
  "notes": "Địa chỉ nhà riêng đã cập nhật"
}

### 2.7 ✅ Đặt địa chỉ mặc định
PATCH {{baseUrl}}/api/user/addresses/{{addressId}}/set-default
Authorization: Bearer {{customerToken}}

### ==================================================================================
### 🏪 SECTION 3: PRODUCT MANAGEMENT TESTS
### ==================================================================================

### 3.1 ✅ Lấy danh sách sản phẩm với filter
GET {{baseUrl}}/api/product?page=1&pageSize=20&inStock=true&sortBy=price&sortOrder=asc
Authorization: Bearer {{customerToken}}

### 3.2 ✅ Tìm kiếm sản phẩm
GET {{baseUrl}}/api/product?search=sake&page=1&pageSize=10
Authorization: Bearer {{customerToken}}

### 3.3 ✅ Lấy chi tiết sản phẩm
# @name getProduct
GET {{baseUrl}}/api/product/1
Authorization: Bearer {{customerToken}}

### 3.4 ✅ Lấy sản phẩm theo SKU
GET {{baseUrl}}/api/product/sku/SAKE001
Authorization: Bearer {{customerToken}}

### 3.5 ✅ [ADMIN] Tạo sản phẩm mới
# @name createProduct
POST {{baseUrl}}/api/product
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Test Sake Premium",
  "shortDescription": "Sake cao cấp từ Nhật Bản",
  "description": "Mô tả chi tiết về sản phẩm sake premium này...",
  "mainImage": "https://example.com/sake-premium.jpg",
  "price": 500000,
  "originalPrice": 600000,
  "stock": 50,
  "status": 1,
  "condition": 0,
  "brandId": 1,
  "categoryId": 1,
  "sku": "TESTPREMIUM1234",
  "tags": "sake, premium, japan"
}

### 3.6 ✅ [ADMIN] Cập nhật sản phẩm
PUT {{baseUrl}}/api/product/38
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Test Sake Premium Updated",
  "shortDescription": "Sake cao cấp từ Nhật Bản - Đã cập nhật",
  "description": "Mô tả chi tiết đã cập nhật...",
  "mainImage": "https://example.com/sake-premium-updated.jpg",
  "price": 480000,
  "originalPrice": 600000,
  "stock": 45,
  "status": 1,
  "condition": 0,
  "isFeatured": true,
  "isNew": true,
  "brandId": 1,
  "categoryId": 1,
  "sku": "TESTPREMIUM001",
  "tags": "sake, premium, japan, updated"
}

### 3.7 ✅ [ADMIN] Cập nhật stock sản phẩm
PATCH {{baseUrl}}/api/product/38/stock
Authorization: Bearer {{adminToken}}
Content-Type: application/json
{
  "newStock": 150,
  "action": 1,
  "reason": "Nhập hàng từ nhà cung cấp ABC"
}

### ==================================================================================
### 🛒 SECTION 4: SHOPPING CART TESTS
### ==================================================================================

### 4.1 ✅ Lấy giỏ hàng hiện tại
GET {{baseUrl}}/api/cart
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 4.2 ✅ Lấy tóm tắt giỏ hàng
GET {{baseUrl}}/api/cart/summary
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 4.3 ✅ Thêm sản phẩm vào giỏ hàng
POST {{baseUrl}}/api/cart/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 1,
  "quantity": 2
}

### 4.4 ✅ Thêm sản phẩm khác vào giỏ hàng
POST {{baseUrl}}/api/cart/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 2,
  "quantity": 1
}

### 4.5 ✅ Cập nhật số lượng sản phẩm trong giỏ
PUT {{baseUrl}}/api/cart/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 1,
  "quantity": 3
}

### 4.6 ✅ Cập nhật hàng loạt giỏ hàng
PUT {{baseUrl}}/api/cart/bulk
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "items": [
    {
      "productId": 1,
      "quantity": 2
    },
    {
      "productId": 2,
      "quantity": 3
    }
  ]
}

### 4.7 ✅ Validate giỏ hàng
POST {{baseUrl}}/api/cart/validate
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 4.8 ✅ Áp dụng coupon (nếu có)
POST {{baseUrl}}/api/cart/coupon/WELCOME10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### ==================================================================================
### 📝 SECTION 5: WISHLIST MANAGEMENT
### ==================================================================================

### 5.1 ✅ Lấy danh sách wishlist
GET {{baseUrl}}/api/wishlist
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 5.2 ✅ Tạo wishlist mới
# @name createWishlist
POST {{baseUrl}}/api/wishlist
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "name": "Sake Favorites",
  "description": "Danh sách sake yêu thích",
  "isPublic": false
}

### 5.3 ✅ Thêm sản phẩm vào wishlist
POST {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 3
}

### 5.4 ✅ Thêm sản phẩm khác vào wishlist
POST {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 4
}

### 5.5 ✅ Chuyển sản phẩm từ wishlist sang cart
POST {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}/items/3/move-to-cart
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 5.6 ✅ Cập nhật wishlist
PUT {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "name": "Sake Favorites Updated",
  "description": "Danh sách sake yêu thích đã cập nhật",
  "isPublic": true
}

### ==================================================================================
### 💳 SECTION 6: ORDER MANAGEMENT
### ==================================================================================

### 6.1 ✅ Validate đơn hàng trước khi tạo
POST {{baseUrl}}/api/order/validate
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "items": [
    {
      "productId": 1,
      "quantity": 2,
      "price": 250000
    },
    {
      "productId": 2,
      "quantity": 1,
      "price": 180000
    }
  ],
  "shippingAddressId": {{createAddress.response.body.data.id}},
  "billingAddressId": {{createAddress.response.body.data.id}},
  "paymentMethod": "COD",
  "shippingMethod": "STANDARD"
}

### 6.2 ✅ Tạo đơn hàng từ cart
# @name createOrder
POST {{baseUrl}}/api/order
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "items": [
    {
      "productId": 1,
      "quantity": 2,
      "price": 250000
    },
    {
      "productId": 2,
      "quantity": 1,
      "price": 180000
    }
  ],
  "shippingAddressId": {{createAddress.response.body.data.id}},
  "billingAddressId": {{createAddress.response.body.data.id}},
  "paymentMethod": "COD",
  "shippingMethod": "STANDARD",
  "customerNotes": "Giao hàng giờ hành chính"
}

### 6.3 ✅ Lấy chi tiết đơn hàng
GET {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 6.4 ✅ Lấy danh sách đơn hàng của user
GET {{baseUrl}}/api/order?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 6.5 ✅ Lấy lịch sử trạng thái đơn hàng
GET {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/status-history
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 6.6 ✅ Thêm ghi chú vào đơn hàng
POST {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/notes
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "note": "Khách hàng muốn giao vào buổi chiều"
}

### 6.7 ✅ Lấy ghi chú đơn hàng
GET {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/notes
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 6.8 ✅ [STAFF] Xác nhận đơn hàng
PATCH {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/confirm
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 6.9 ✅ [STAFF] Xử lý đơn hàng
PATCH {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/process
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "processedBy": "admin",
  "notes": "Đơn hàng đã được xử lý và chuẩn bị giao hàng",
  "estimatedShipDate": "2024-01-15"
}

### 6.10 ✅ [STAFF] Giao hàng
PATCH {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/ship
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "carrier": "GHN",
  "trackingNumber": "GHN123456789",
  "shippedDate": "2024-01-15T10:00:00Z",
  "estimatedDeliveryDate": "2024-01-17T18:00:00Z",
  "notes": "Đã giao cho đơn vị vận chuyển"
}

### 6.11 ✅ [STAFF] Hoàn thành đơn hàng
PATCH {{baseUrl}}/api/order/{{createOrder.response.body.data.id}}/deliver
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 6.12 ✅ [STAFF] Lấy thống kê đơn hàng
GET {{baseUrl}}/api/order/stats?fromDate=2024-01-01&toDate=2024-12-31
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 6.13 ✅ [STAFF] Lấy đơn hàng gần đây
GET {{baseUrl}}/api/order/recent?count=10
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### ==================================================================================
### 💰 SECTION 7: PAYMENT SYSTEM
### ==================================================================================

### 7.1 ✅ Lấy danh sách phương thức thanh toán
GET {{baseUrl}}/api/payment/methods
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 7.2 ✅ Tạo payment cho đơn hàng
# @name createPayment
POST {{baseUrl}}/api/payment
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "orderId": {{createOrder.response.body.data.id}},
  "paymentMethod": "COD",
  "amount": 680000
}

### 7.3 ✅ Lấy chi tiết payment
GET {{baseUrl}}/api/payment/{{createPayment.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 7.4 ✅ Lấy lịch sử payment của user
GET {{baseUrl}}/api/payment/history?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 7.5 ✅ [ADMIN] Xử lý payment
PATCH {{baseUrl}}/api/payment/{{createPayment.response.body.data.id}}/process
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "status": "Completed",
  "notes": "Thanh toán khi nhận hàng đã hoàn thành"
}

### ==================================================================================
### 📦 SECTION 8: SHIPPING SYSTEM
### ==================================================================================

### 8.1 ✅ Tính phí vận chuyển
POST {{baseUrl}}/api/shipping/calculate-rates
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "fromProvinceCode": "HCM",
  "toProvinceCode": "HN",
  "weight": 2.0,
  "orderValue": 680000
}

### 8.2 ✅ Lấy danh sách nhà vận chuyển
GET {{baseUrl}}/api/shipping/providers
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 8.3 ✅ [ADMIN] Tạo shipping order
# @name createShipping
POST {{baseUrl}}/api/shipping/orders
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "orderId": {{createOrder.response.body.data.id}},
  "serviceType": "STANDARD",
  "isCOD": true,
  "codAmount": 680000,
  "notes": "Giao hàng thận trọng"
}

### 8.4 ✅ Tracking đơn hàng
GET {{baseUrl}}/api/shipping/track/GHN123456789
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### ==================================================================================
### ⭐ SECTION 9: REVIEWS & RATINGS
### ==================================================================================

### 9.1 ✅ Viết đánh giá sản phẩm
# @name createReview
POST {{baseUrl}}/api/review
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 1,
  "orderId": {{createOrder.response.body.data.id}},
  "rating": 5,
  "title": "Sản phẩm tuyệt vời!",
  "comment": "Chất lượng rất tốt, đóng gói cẩn thận, giao hàng nhanh chóng. Sẽ mua lại!"
}

### 9.2 ✅ Lấy đánh giá của sản phẩm
GET {{baseUrl}}/api/review/product/1?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 9.3 ✅ Lấy tóm tắt đánh giá sản phẩm
GET {{baseUrl}}/api/review/product/1/summary
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 9.4 ✅ Cập nhật đánh giá
PUT {{baseUrl}}/api/review/{{createReview.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "rating": 5,
  "title": "Sản phẩm tuyệt vời! (Updated)",
  "comment": "Chất lượng rất tốt, đóng gói cẩn thận, giao hàng nhanh chóng. Sẽ mua lại! Đã dùng 1 tuần rất ưng ý."
}

### 9.5 ✅ Lấy đánh giá của user
GET {{baseUrl}}/api/review/user?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### ==================================================================================
### 🎫 SECTION 10: COUPONS & PROMOTIONS
### ==================================================================================

### 10.1 ✅ Lấy danh sách coupon có sẵn
GET {{baseUrl}}/api/coupon/active?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 10.2 ✅ Kiểm tra coupon hợp lệ
GET {{baseUrl}}/api/coupon/WELCOME10/validate
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 10.3 ✅ [ADMIN] Tạo coupon mới
# @name createCoupon
POST {{baseUrl}}/api/coupon
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "code": "TESTCOUPON50",
  "name": "Test Coupon 50%",
  "description": "Giảm 50% cho đơn hàng test",
  "discountType": "Percentage",
  "discountValue": 50,
  "minOrderValue": 100000,
  "maxDiscountAmount": 250000,
  "startDate": "2024-01-01T00:00:00Z",
  "endDate": "2024-12-31T23:59:59Z",
  "usageLimit": 100,
  "isActive": true
}

### 10.4 ✅ [ADMIN] Cập nhật coupon
PUT {{baseUrl}}/api/coupon/{{createCoupon.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "code": "TESTCOUPON50",
  "name": "Test Coupon 50% Updated",
  "description": "Giảm 50% cho đơn hàng test - đã cập nhật",
  "discountType": "Percentage",
  "discountValue": 40,
  "minOrderValue": 150000,
  "maxDiscountAmount": 200000,
  "startDate": "2024-01-01T00:00:00Z",
  "endDate": "2024-12-31T23:59:59Z",
  "usageLimit": 50,
  "isActive": true
}

### 10.5 ✅ [ADMIN] Lấy thống kê coupon
GET {{baseUrl}}/api/coupon/stats
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### ==================================================================================
### 📧 SECTION 11: NOTIFICATIONS
### ==================================================================================

### 11.1 ✅ Lấy danh sách thông báo của user
GET {{baseUrl}}/api/notification?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 11.2 ✅ Lấy số lượng thông báo chưa đọc
GET {{baseUrl}}/api/notification/unread-count
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 11.3 ✅ Đánh dấu tất cả thông báo đã đọc
PATCH {{baseUrl}}/api/notification/mark-all-read
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 11.4 ✅ [ADMIN] Gửi thông báo cho user
POST {{baseUrl}}/api/notification/send
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "userId": "{{loginCustomer.response.body.data.user.id}}",
  "title": "Chào mừng bạn đến với SakuraHome",
  "message": "Cảm ơn bạn đã đăng ký tài khoản. Hãy khám phá các sản phẩm tuyệt vời của chúng tôi!",
  "type": "WELCOME",
  "priority": "Normal"
}

### 11.5 ✅ [ADMIN] Gửi thông báo hàng loạt
POST {{baseUrl}}/api/notification/broadcast
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "title": "Flash Sale 50% - Chỉ hôm nay!",
  "message": "Khuyến mãi lớn nhất trong năm! Giảm giá 50% tất cả sản phẩm sake premium. Nhanh tay đặt hàng!",
  "type": "PROMOTION",
  "priority": "High",
  "userSegment": "All"
}

### ==================================================================================
### 👨‍💼 SECTION 12: ADMIN OPERATIONS
### ==================================================================================

### 12.1 ✅ [ADMIN] Lấy danh sách người dùng
GET {{baseUrl}}/api/admin/users?page=1&pageSize=10&role=Customer
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 12.2 ✅ [ADMIN] Lấy chi tiết người dùng
GET {{baseUrl}}/api/admin/users/{{loginCustomer.response.body.data.user.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 12.3 ✅ [ADMIN] Tạo người dùng mới
# @name createUser
POST {{baseUrl}}/api/admin/users
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "email": "staff.test@sakurahome.com",
  "password": "StaffPass123!",
  "firstName": "Test",
  "lastName": "Staff",
  "phoneNumber": "+84901234568",
  "role": "Staff",
  "status": "Active"
}

### 12.4 ✅ [ADMIN] Cập nhật thông tin người dùng
PUT {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "firstName": "Test Updated",
  "lastName": "Staff Updated",
  "phoneNumber": "+84901234568",
  "role": "Staff",
  "status": "Active"
}

### 12.5 ✅ [ADMIN] Thay đổi trạng thái người dùng
PATCH {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}/status
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "status": "Inactive",
  "reason": "Temporary suspension for testing"
}

### 12.6 ✅ [ADMIN] Reset mật khẩu người dùng
POST {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}/reset-password
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "newPassword": "NewStaffPass123!"
}

### 12.7 ✅ [ADMIN] Mở khóa tài khoản người dùng
POST {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}/unlock
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 12.8 ✅ [ADMIN] Xác thực email người dùng
POST {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}/verify-email
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 12.9 ✅ [ADMIN] Lấy thống kê người dùng
GET {{baseUrl}}/api/admin/users/stats
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### ==================================================================================
### 🔧 SECTION 13: BRAND & CATEGORY MANAGEMENT
### ==================================================================================

### 13.1 ✅ Lấy danh sách thương hiệu
GET {{baseUrl}}/api/brand?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 13.2 ✅ Lấy thương hiệu nổi bật
GET {{baseUrl}}/api/brand/featured
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 13.3 ✅ [ADMIN] Tạo thương hiệu mới
# @name createBrand
POST {{baseUrl}}/api/brand
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "name": "Test Brand Premium",
  "slug": "test-brand-premium",
  "description": "Thương hiệu cao cấp từ Nhật Bản",
  "logoUrl": "https://example.com/brand-logo.jpg",
  "website": "https://testbrand.com",
  "country": "Japan",
  "foundedYear": 1950,
  "isActive": true,
  "isFeatured": true
}

### 13.4 ✅ Lấy danh sách danh mục
GET {{baseUrl}}/api/category?page=1&pageSize=10
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 13.5 ✅ Lấy danh mục gốc
GET {{baseUrl}}/api/category/root
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 13.6 ✅ [ADMIN] Tạo danh mục mới
# @name createCategory
POST {{baseUrl}}/api/category
Authorization: Bearer {{loginAdmin.response.body.data.token}}
Content-Type: application/json

{
  "name": "Test Premium Sake",
  "slug": "test-premium-sake",
  "description": "Danh mục sake cao cấp test",
  "imageUrl": "https://example.com/category-image.jpg",
  "parentId": null,
  "displayOrder": 1,
  "isActive": true,
  "isFeatured": true
}

### ==================================================================================
### 🏠 SECTION 14: ADDRESS LOOKUP & SYSTEM
### ==================================================================================

### 14.1 ✅ Lấy danh sách tỉnh thành
GET {{baseUrl}}/api/address/provinces
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 14.2 ✅ Lấy danh sách phường xã theo tỉnh
GET {{baseUrl}}/api/address/provinces/1/wards
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### ==================================================================================
### 🔍 SECTION 15: SYSTEM HEALTH & DEBUG
### ==================================================================================

### 15.1 ✅ Kiểm tra tình trạng hệ thống
GET {{baseUrl}}/api/product/debug

### 15.2 ✅ Test kết nối database
GET {{baseUrl}}/api/health

### ==================================================================================
### 🧹 SECTION 16: CLEANUP OPERATIONS
### ==================================================================================

### 16.1 ✅ Xóa sản phẩm test từ wishlist
DELETE {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}/items/4
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 16.2 ✅ Xóa sản phẩm khỏi giỏ hàng
DELETE {{baseUrl}}/api/cart/items
Authorization: Bearer {{loginCustomer.response.body.data.token}}
Content-Type: application/json

{
  "productId": 2
}

### 16.3 ✅ [ADMIN] Xóa coupon test
DELETE {{baseUrl}}/api/coupon/{{createCoupon.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 16.4 ✅ [ADMIN] Xóa sản phẩm test
DELETE {{baseUrl}}/api/product/{{createProduct.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 16.5 ✅ [ADMIN] Xóa thương hiệu test
DELETE {{baseUrl}}/api/brand/{{createBrand.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 16.6 ✅ [ADMIN] Xóa danh mục test
DELETE {{baseUrl}}/api/category/{{createCategory.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 16.7 ✅ Xóa địa chỉ test
DELETE {{baseUrl}}/api/user/addresses/{{createAddress.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 16.8 ✅ Xóa wishlist test
DELETE {{baseUrl}}/api/wishlist/{{createWishlist.response.body.data.id}}
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 16.9 ✅ [ADMIN] Xóa user test
DELETE {{baseUrl}}/api/admin/users/{{createUser.response.body.data.id}}
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### 16.10 ✅ Đăng xuất khách hàng
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{loginCustomer.response.body.data.token}}

### 16.11 ✅ Đăng xuất admin
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{loginAdmin.response.body.data.token}}

### ==================================================================================
### 📊 FINAL SUMMARY & VERIFICATION
### ==================================================================================

### 17.1 ✅ Kiểm tra hệ thống sau khi test
GET {{baseUrl}}/api/product/debug

### ==================================================================================
### 🎯 TEST COMPLETION SUMMARY
### ==================================================================================

###
### ✅ HOÀN THÀNH TEST TẤT CẢ CHỨC NĂNG CHÍNH:
### 
### 🔐 Authentication & Authorization (13 tests)
### 👤 User Profile & Address Management (7 tests)  
### 🏪 Product Management (7 tests)
### 🛒 Shopping Cart (8 tests)
### 📝 Wishlist Management (6 tests)
### 💳 Order Management (13 tests)
### 💰 Payment System (5 tests)
### 📦 Shipping System (4 tests)
### ⭐ Reviews & Ratings (5 tests)
### 🎫 Coupons & Promotions (5 tests)
### 📧 Notifications (5 tests)
### 👨‍💼 Admin Operations (9 tests)
### 🔧 Brand & Category Management (6 tests)
### 🏠 Address Lookup (2 tests)
### 🔍 System Health (2 tests)
### 🧹 Cleanup Operations (11 tests)
### 
### 📈 TỔNG CỘNG: 108 TEST CASES
### 
### 🎯 COVERAGE:
### ✅ Authentication & Security
### ✅ User Management (CRUD)
### ✅ Product Management (CRUD)
### ✅ E-commerce Workflow (Cart → Order → Payment → Shipping)
### ✅ Content Management (Reviews, Ratings)
### ✅ Marketing Features (Coupons, Notifications)
### ✅ Admin Operations
### ✅ System Integration
### 
### 🔒 BẢO MẬT:
### ✅ Role-based access control
### ✅ Token authentication
### ✅ Data validation
### ✅ Cross-user protection
### 
### 💡 HƯỚNG DẪN SỬ DỤNG:
### 1. Chạy từng section theo thứ tự
### 2. Kiểm tra response của mỗi request
### 3. Sử dụng variables để link giữa các requests
### 4. Chạy cleanup sau khi test xong
### 
### 🚀 KẾT QUẢ MONG ĐỢI:
### - Tất cả API endpoints hoạt động bình thường
### - Database được cập nhật chính xác
### - Security rules được enforce
### - Business logic được thực thi đúng
### 
### File test này là một bộ test integration hoàn chỉnh cho toàn bộ hệ thống SakuraHome API!
###